---
- name: Install psutil
  pip:
    name:
      - psutil
    state: present

- name: Enable tap to click on touchpad
  community.general.dconf:
    key: "/org/gnome/desktop/peripherals/touchpad/tap-to-click"
    value: "true"

- name: Show battery percentage
  community.general.dconf:
    key: "/org/gnome/desktop/interface/show-battery-percentage"
    value: "true"

- name: Show apps in current workspace only on Alt+Tab
  community.general.dconf:
    key: "/org/gnome/shell/app-switcher/current-workspace-only"
    value: "true"

- name: Load gnome terminal profile generated with pywal
  command:
    cmd: "dconf load /org/gnome/terminal/legacy/profiles:/"
    stdin: "{{ lookup('file', '{{ ansible_env.HOME }}/.cache/wal/gnome-terminal-profile') }}"
  changed_when: false

- name: Don't download updates automatically with GNOME software
  community.general.dconf:
    key: "/org/gnome/software/download-updates"
    value: "false"

- name: Enable jle64/gnome-pass-search-provider
  become: true
  community.general.copr:
    name: jle64/gnome-pass-search-provider
    state: enabled

- name: Install gnome-pass-search-provider
  become: true
  dnf:
    name:
      - gnome-pass-search-provider
    state: present

- name: Disable GNOME search providers
  community.general.dconf:
    key: "/org/gnome/desktop/search-providers"
    value: "['org.gnome.Contacts.desktop', 'org.gnome.Nautilus.desktop', 'org.gnome.Boxes.desktop', 'org.gnome.Calculator.desktop', 'org.gnome.Calendar.desktop', 'org.gnome.Characters.desktop', 'firefox.desktop', 'org.gnome.Photos.desktop', 'org.gnome.clocks.desktop', 'org.gnome.Terminal.desktop']"
