---
- name: Install nvim in Linux
  import_tasks: linux.yml
  when: ansible_distribution == "Ubuntu" or ansible_distribution == "Fedora"

- name: Install nvim in macOS
  import_tasks: macos.yml
  when: ansible_distribution == "MacOSX"

- name: Install pynvim
  ansible.builtin.pip:
    name:
      - pynvim
    state: present
    executable: pip3

- name: Install treesitter parsers
  shell:
    cmd: nvim --headless -c 'TSInstallSync! {{ parsers | join(" ") }}' -c quit
  vars:
    parsers:
      - typescript
      - javascript
      - tsx
      - html
      - yaml
      - toml
      - jsonc
      - python
      - jsdoc
      - lua
      - bash
      - vim
      - scss
      - astro
      - markdown
      - markdown_inline
  changed_when: false
